***************
Taylor Diagrams
***************

Description
===========

Taylor diagrams are used to show a relationship between continuous
statistics (:ref:`Taylor, 2001<Taylor>`). This type of plot is  used to
quantify the degree of correspondence between the forecasts and
observations with respect to three continuous statistics: the Pearson
correlation coefficient, the root-mean-square error (RMSE), and the
standard deviation. This output can be produced by many of the MET tools
(Point-Stat, Grid-Stat, etc.) via the continuous statistics line type. In
METviewer, continuous statistics can be accumulated over some time
period but kept separate for different models, lead times, observation
sources, domains, etc. 

The distance between each forecast and the observation on the graph is
a measure of how realistically each forecast reproduces that observation.
For each forecast, three statistics are plotted: the Pearson correlation
coefficient (:ref:`Wilks, 2011<Wilks>`; a measure of pattern similarity
between the forecast and observed fields) is related to the azimuthal
angle; the normalized (bias-corrected) RMSE in the forecast field is
proportional to the distance from the point on the x-axis identified
as “observed”. The standard deviation of the forecast is proportional
to the radial distance from the origin. The means of the fields are
subtracted out before computing their second-order statistics
(e.g. bias-corrected RMSE), so the diagram does not provide information
about biases. Rather, it characterizes the pattern error.

So, better forecasts lie closer on the Taylor diagram to observation
point, while worse forecasts lie further away.

Line Type
=========

Taylor requires continuous statistics, SL1L2, generated by either
Point-Stat or Grid-Stat. 

How-To
======

Selection of options to produce the Taylor diagram proceeds
approximately counter-clockwise around the METviewer window.

#. Select the desired database from the “Select databases” pulldown
   menu at the top margin of the METviewer window.

#. There are a number of tabs just under the database pulldown menu.
   Select the ‘Taylor’ tab.

#. Select the dependent variable to calculate statistics for in the
   “Y1 Dependent (Forecast)  Variables” tab. The first pulldown menu
   in the “Y1 Dependent (Forecast) Variables” section lists the
   variables available in the selected database.
  
#. Select the Y1 Series Variable from the first pulldown menu in that
   section. There are many options. The example below uses two series
   variables, “MODEL” and "VX_MASK". In the second pulldown menu to the
   right of the first are the series variable options, for example,
   different models.
   
#. It usually does not make sense to mix statistics for different groups.
   The desired group to calculate statistics over can be specified in
   the “Fixed Values” section. If multiple domains or thresholds were
   chosen, the statistics would be a summary of all of those cases
   together, which may not always be desired.

#. Choose the display option in the "Display" section. There are two options. 

   * Values of Correlation: Select to show only positive correlation
     values or show all correlation values. 

   * Standard Deviation Arcs: Select whether to display or hide the
     standard deviation arcs.


#. Now enough information has been entered to produce a graph. To do
   this, click the “Generate Plot” button at the top of the METviewer
   window (this is in red text). Typically, if a plot is not produced,
   it is because the database selected does not contain the correct
   type of data. Also, it is imperative to check the data used for the
   plot by selecting the “R data” tab on the right hand side, above the
   plot area. The data from the database that is being used to calculate
   the statistics is listed in this tab. This tab should be checked to
   avoid the accidental accumulation of inappropriate database lines.
   For example, it does not make sense to accumulate statistics over
   different domains, thresholds, models, etc.

There are many other options for plots, but these are the basics.


Example
=======

The example Taylor diagram below shows the downward longwave radiation
flux (DLWRF) correlation and standard deviation for one model and seven
locations. The model forecast performs well for the Bondville and Fort
Peck locations. The Bondville location has the best value of 0.85
correlation and near 1 values of standard deviation. The ideal value
is 1, which corresponds to perfect correlation and matching standard
deviations between model and observation. 

.. figure:: figure/taylor_diagram.png

	    Example Taylor diagram.

Here is the associated xml for this example. It can be copied into an
empty file and saved to the desktop then uploaded into the system by
clicking on the “Load XML” button in the upper-right corner of the GUI.
This XML can be downloaded from this link:
`taylor_diagram.xml <https://dtcenter.github.io/METviewer/latest/_static/xml/taylor_diagram.xml>`_

.. literalinclude:: ../_static/xml/taylor_diagram.xml
